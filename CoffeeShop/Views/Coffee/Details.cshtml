@model CoffeeShop.Models.CoffeeModel
@using CoffeeShop.Models
@using CoffeeShop.Enumerations

@{
    ViewBag.Title = "Coffee Details";
}
<br />

@if (ViewBag.Statistics != null)
{
    <div>
        Statistics about coffee:
    </div>
    <div>
        <ul>
            <li>Number of total times sold: @Model.TotalQuantitySold</li>
            <li>Number of total times sold this week: @Model.QuantitySoldLastWeek</li>
            <li>Number of items in stock: @Model.QuantityInStock</li>
            <li>Total profit achieved: @ViewBag.TotalProfit</li>
            <li>Total profit achieved this week: @ViewBag.TotalProfitWeek</li>
        </ul>
    </div>
}

<div style="margin:auto; width:50%; border:3px solid gray; padding:10px" class="bg-primary card text-center">
    @ViewBag.Title<br /><br />
    <img class="card-img-top" src="@Model.ImgUrl" alt="Coffee" width="100%">
    <div class="card-body">
        <br />
        <h5 class="card-title">Ingredients: </h5>
        @{
            if (ViewBag.IngredientsForCoffee.Count == 0)
            {
                <p class="card-text">Basic coffee (no ingredients)</p>
                <br />
            }
            else
            {
                <p class="card-text">
                    @{
                        foreach (IngredientInCoffeeModel ingredientQuantity in (List<IngredientInCoffeeModel>)ViewBag.IngredientsForCoffee)
                        {
                            <strong>@ingredientQuantity.Ingredient.Name x @ingredientQuantity.Quantity, Price: @(ingredientQuantity.Ingredient.Price*ingredientQuantity.Quantity) </strong>
                            <br />
                        }
                    }<br />
                </p>
            }
        }

    </div>
    <ul class="list-group list-group-flush">
        <li class="list-group-item bg-danger">Name: @Model.Name</li>
        <li class="list-group-item bg-danger">Price: @Model.TotalPrice denars.</li>
        <li class="list-group-item bg-danger">Size: @Model.Size</li>
        <li class="list-group-item bg-danger">Description: @Model.Description</li>
    </ul><br />
         <div class="card-body">
             @if (ViewBag.Statistics != null)
             {
                 @Html.ActionLink("Back to Statistics", "CoffeeStatistics", routeValues: null, htmlAttributes: new { @class = "card-link btn btn-info btn-block" })

             }
             else
             {
                 if (User.IsInRole(UserRoles.User))
                 {
                     @Html.ActionLink("Add to shopping cart", "Create", "OrderItem", new { id = @Model.CoffeeId }, new { @class = "btn btn-success btn-block" })
                 }
                 @Html.ActionLink("Back to List", "Index", routeValues: null, htmlAttributes: new { @class = "btn btn-info btn-block" })
             }
             @{
                 if (User.IsInRole(UserRoles.Admin) || User.IsInRole(UserRoles.Owner))
                 {
                     @Html.ActionLink("Edit", "Edit", new { id = Model.CoffeeId }, new { @class = "btn btn-warning btn-block" })
                 }
             }
         </div>
</div>

@section Styles{
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">
}